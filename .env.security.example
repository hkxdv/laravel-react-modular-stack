# =============================================================================
# CONFIGURACIÓN DE SEGURIDAD PARA SISTEMA DUAL DE AUTENTICACIÓN
# =============================================================================
# Este archivo contiene todas las variables de entorno relacionadas con
# la seguridad del sistema.

# =============================================================================
# CONFIGURACIÓN GENERAL DE SEGURIDAD
# =============================================================================

# Forzar HTTPS en producción
FORCE_HTTPS=true

# Configuración de sesiones
SESSION_LIFETIME=120
SESSION_EXPIRE_ON_CLOSE=false
SESSION_ENCRYPT=true
SESSION_SECURE_COOKIE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=lax

# =============================================================================
# CONFIGURACIÓN ESPECÍFICA PARA STAFF
# =============================================================================

# Límites de intentos de login para staff
STAFF_MAX_LOGIN_ATTEMPTS=3
STAFF_LOCKOUT_DURATION=900
STAFF_THROTTLE_WINDOW=300

# Configuración de sesiones para staff
STAFF_SESSION_TIMEOUT=7200
STAFF_REMEMBER_ME=false
STAFF_CONCURRENT_SESSIONS=1
STAFF_FORCE_LOGOUT_IP_CHANGE=true

# Requisitos de contraseña para staff
STAFF_PASSWORD_MIN_LENGTH=12
STAFF_PASSWORD_REQUIRE_UPPERCASE=true
STAFF_PASSWORD_REQUIRE_LOWERCASE=true
STAFF_PASSWORD_REQUIRE_NUMBERS=true
STAFF_PASSWORD_REQUIRE_SYMBOLS=true
STAFF_PASSWORD_MAX_AGE_DAYS=90
STAFF_PASSWORD_HISTORY_COUNT=12
STAFF_PASSWORD_RESET_EXPIRY=15

# Autenticación de dos factores para staff
STAFF_2FA_REQUIRED=true

# =============================================================================
# CONFIGURACIÓN DE AUDITORÍA Y LOGGING
# =============================================================================

# Habilitar auditoría de seguridad
SECURITY_AUDIT_ENABLED=true
LOG_FAILED_LOGINS=true
LOG_SUCCESSFUL_LOGINS=true
LOG_PASSWORD_CHANGES=true
LOG_SESSION_EVENTS=true
AUDIT_RETENTION_DAYS=365

# =============================================================================
# CONFIGURACIÓN DE HEADERS DE SEGURIDAD
# =============================================================================

# HTTP Strict Transport Security
HSTS_MAX_AGE=31536000

# Content Security Policy
CSP_ENABLED=true

# Otros headers de seguridad
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
REFERRER_POLICY=strict-origin-when-cross-origin

# =============================================================================
# CONFIGURACIÓN DE DETECCIÓN DE AMENAZAS
# =============================================================================

# Habilitar detección de amenazas
THREAT_DETECTION_ENABLED=true
NOTIFY_ADMIN_THREATS=true
TEMPORARY_BLOCK_THREATS=true
THREAT_BLOCK_DURATION=60
BLOCK_TOR_NODES=false

# =============================================================================
# CONFIGURACIÓN DE VALIDACIÓN DE ENTRADA
# =============================================================================

# Límites de entrada
MAX_REQUEST_SIZE=10M
MAX_FILE_UPLOADS=20
SANITIZE_INPUT=true
STRIP_TAGS=true

# =============================================================================
# CONFIGURACIÓN DE BACKUP Y RECUPERACIÓN
# =============================================================================

# Configuración de backups de seguridad
SECURITY_BACKUP_ENABLED=true
BACKUP_FREQUENCY=daily
BACKUP_RETENTION_DAYS=30
ENCRYPT_BACKUPS=true
VERIFY_BACKUP_INTEGRITY=true

# =============================================================================
# CONFIGURACIÓN DE RATE LIMITING AVANZADO
# =============================================================================

# Rate limiting por IP
RATE_LIMIT_PER_IP=100
RATE_LIMIT_WINDOW=60

# Rate limiting por usuario
RATE_LIMIT_PER_USER=200
RATE_LIMIT_USER_WINDOW=60

# Rate limiting para APIs
API_RATE_LIMIT=1000
API_RATE_LIMIT_WINDOW=3600

# =============================================================================
# CONFIGURACIÓN DE NOTIFICACIONES DE SEGURIDAD
# =============================================================================

# Email para notificaciones de seguridad
SECURITY_NOTIFICATION_EMAIL=admin@example.com

# Slack webhook para alertas críticas
SECURITY_SLACK_WEBHOOK=

# Habilitar notificaciones por email
EMAIL_SECURITY_ALERTS=true

# Habilitar notificaciones por Slack
SLACK_SECURITY_ALERTS=false

# =============================================================================
# CONFIGURACIÓN DE DESARROLLO/TESTING
# =============================================================================

# Deshabilitar algunas validaciones en desarrollo (NO usar en producción)
DEV_DISABLE_2FA=false
DEV_DISABLE_RATE_LIMITING=false
DEV_DISABLE_HTTPS_REDIRECT=false
DEV_ALLOW_WEAK_PASSWORDS=false
